<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>dumpsys SurfaceFlinger数据分析 | 扶摇直上鹏</title><meta name="keywords" content="性能优化"><meta name="author" content="扶摇直上鹏"><meta name="copyright" content="扶摇直上鹏"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="遇到显示问题，有现场的我们一般都会去dumpsys sf的信息来定位；没有现场的我们也会去看bugreport中的sf信息来分析。">
<meta property="og:type" content="article">
<meta property="og:title" content="dumpsys SurfaceFlinger数据分析">
<meta property="og:url" content="http://example.com/2021/09/06/dumpsys%20SurfaceFlinger%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="扶摇直上鹏">
<meta property="og:description" content="遇到显示问题，有现场的我们一般都会去dumpsys sf的信息来定位；没有现场的我们也会去看bugreport中的sf信息来分析。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/sf_cover.jpg">
<meta property="article:published_time" content="2021-09-06T13:00:00.000Z">
<meta property="article:modified_time" content="2021-09-05T16:00:00.000Z">
<meta property="article:author" content="扶摇直上鹏">
<meta property="article:tag" content="性能优化">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/sf_cover.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2021/09/06/dumpsys%20SurfaceFlinger%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: '',
  enable_page_level_ads: 'true'
});</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: 扶摇直上鹏","link":"链接: ","source":"来源: 扶摇直上鹏","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'dumpsys SurfaceFlinger数据分析',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2021-09-06 00:00:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.css"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/logo.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/page_top.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">扶摇直上鹏</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">dumpsys SurfaceFlinger数据分析</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-09-06T13:00:00.000Z" title="发表于 2021-09-06 21:00:00">2021-09-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-09-05T16:00:00.000Z" title="更新于 2021-09-06 00:00:00">2021-09-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">性能优化</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/">常用工具</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="dumpsys SurfaceFlinger数据分析"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>&emsp;&emsp;遇到显示问题，有现场的我们一般都会去dumpsys sf的信息来定位；没有现场的我们也会去看 bugreport中的sf信息来分析。</p>
<p>&emsp;&emsp;命令如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;adb shell dumpsys SurfaceFlinger &gt; sf.txt</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;在对应的目录路径下生成sf.txt文件，我们来解析下。</p>
<ul>
<li>SurfaceFlinger配置信息。这里是说明已打开的宏：sf、libui、libgui。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Build configuration: [sf PRESENT_TIME_OFFSET=<span class="number">0</span> FORCE_HWC_FOR_RBG_TO_YUV=<span class="number">1</span> MAX_VIRT_DISPLAY_DIM=<span class="number">4096</span> RUNNING_WITHOUT_SYNC_FRAMEWORK=<span class="number">0</span> NUM_FRAMEBUFFER_SURFACE_BUFFERS=<span class="number">3</span>] [libui] [libgui]</span><br></pre></td></tr></table></figure>



<ul>
<li>显示设备唯一性信息。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Display identification data:</span><br><span class="line">Display 19260810807042689 (HWC display 0): port&#x3D;129 pnpId&#x3D;QCM displayName&#x3D;&quot;&quot;</span><br></pre></td></tr></table></figure>



<ul>
<li>广色域信息。三种colorMode，该设备用的是SRGB。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Wide-Color information:</span><br><span class="line">Device has wide color built-in display: 1</span><br><span class="line">Device uses color management: 1</span><br><span class="line">DisplayColorSetting: Unknown 258</span><br><span class="line">Display 19260810807042689 color modes:</span><br><span class="line">ColorMode::NATIVE (0)</span><br><span class="line">ColorMode::SRGB (7)</span><br><span class="line">ColorMode::DISPLAY_P3 (9)</span><br><span class="line">Current color mode: ColorMode::SRGB (7)</span><br></pre></td></tr></table></figure>



<ul>
<li>同步机制。2个GL扩展：EGL_ANDROID_native_fence_sync和EGL_KHR_wait_sync。OpenGL ES同步 集成依赖于这两个EGL扩展。<ul>
<li>EGL_ANDROID_native_fence_sync：提供了一种在EGLSyncKHR对象中封装或创建原生Android栅 栏文件描述符的方式；</li>
<li>EGL_KHR_wait_sync：允许GPU端暂停而不是CPU端暂停，从而使GPU等待EGLSyncKHR；</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sync configuration: [using: EGL_ANDROID_native_fence_sync EGL_KHR_wait_sync]</span><br></pre></td></tr></table></figure>



<ul>
<li>Scheduler信息。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Scheduler:</span><br><span class="line">+ Idle timer: off</span><br><span class="line">+ Touch timer: 200 ms</span><br><span class="line">+ Use content detection: off</span><br></pre></td></tr></table></figure>



<ul>
<li>刷新率信息。可以看到VSYNC的间隔是16.6毫秒（60fps）,SF和app的offset（间隔）是0ns。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ScreenOff: 0d19:46:27.503</span><br><span class="line">60fps: 1d22:35:08.818</span><br><span class="line">app phase: 1000000 ns SF phase: 1000000 ns</span><br><span class="line">early app phase: 1000000 ns early SF phase: 1000000 ns</span><br><span class="line">GL early app phase: 1000000 ns GL early SF phase: 1000000 ns</span><br><span class="line">next VSYNC threshold: 9223372036854775807 ns</span><br><span class="line">present offset: 0 ns VSYNC period: 16666666 ns</span><br></pre></td></tr></table></figure>



<ul>
<li>显示配置信息：primary range：主要的刷新率范围；app request range：app请求刷新率范围。后 者将大于或者等于前者的值，永远不会更小。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DesiredDisplayConfigSpecs (DisplayManager): default config ID: 0, primary range:</span><br><span class="line">[0.00 340282346638528859811704183484516925440.00], app request range: [0.00</span><br><span class="line">340282346638528859811704183484516925440.00]</span><br><span class="line">(config override by backdoor: no)</span><br></pre></td></tr></table></figure>



<ul>
<li>app相关信息。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">app: state&#x3D;Idle VSyncState&#x3D;&#123;displayId&#x3D;19260810807042689, count&#x3D;7507972&#125;</span><br><span class="line">pending events (count&#x3D;0):</span><br><span class="line">connections (count&#x3D;46):</span><br><span class="line">Connection&#123;0xb40000707dbc80e0, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000710a8a3aa0, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000710a8a3be0, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000707d72f240, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000707d72f380, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000707d72f7e0, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000708320f5a0, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000708320fa00, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000708320f780, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000708320f820, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000708320fbe0, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000708320ff00, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb400007083210040, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb400007083210ae0, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb400007083211620, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000707d920640, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb400007083211580, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb400007083212660, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb4000070833fc300, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb4000070833fb0e0, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb400007083212980, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb400007083332720, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb4000070833fc1c0, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb400007083334840, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb4000070833fbd60, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000706ff3c280, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000706ffc6da0, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000707004d2e0, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb4000070833e5020, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb400007072826640, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000707285aa00, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000707285b2c0, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb4000070833e5200, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000706f901840, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000706f900800, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000707282ad80, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000707285d160, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000706f95cb40, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000706f8ffae0, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000706f95e300, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000706f95c460, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000706f902ce0, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000706f91a000, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000706f960060, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000706f95f5c0, VSyncRequest::None&#125;</span><br><span class="line">Connection&#123;0xb40000707285dfc0, VSyncRequest::None&#125;</span><br><span class="line">VsyncReactor in use</span><br><span class="line">Has 0 unfired fences</span><br><span class="line">mInternalIgnoreFences&#x3D;0 mExternalIgnoreFences&#x3D;0</span><br><span class="line">mMoreSamplesNeeded&#x3D;0 mPeriodConfirmationInProgress&#x3D;0</span><br><span class="line">mPeriodTransitioningTo&#x3D;nullptr</span><br><span class="line">No Last HW vsync</span><br></pre></td></tr></table></figure>



<ul>
<li>这个CallbackRepeaters不是太明白什么意思，来个大佬解惑下~、</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">CallbackRepeaters:</span><br><span class="line">app: mPeriod&#x3D;16.67 last vsync time -3413.83ms relative to now (stopped)</span><br><span class="line">CallbackRepeaters:</span><br><span class="line">app: mPeriod&#x3D;16.67 last vsync time -3413.83ms relative to now (stopped)</span><br><span class="line">SamplingThreadDispSyncListener: mPeriod&#x3D;16.67 last vsync time -36455.65ms</span><br><span class="line">relative to now (stopped)</span><br><span class="line">sf: mPeriod&#x3D;16.67 last vsync time -3413.83ms relative to now (stopped)</span><br><span class="line">VSyncTracker:</span><br><span class="line">mIdealPeriod&#x3D;16.67</span><br><span class="line">Refresh Rate Map:</span><br><span class="line">For ideal period 16.67ms: period &#x3D; 16.72ms, intercept &#x3D; 14524</span><br><span class="line">VSyncDispatch:</span><br><span class="line">Timer:</span><br><span class="line">DebugState: Waiting</span><br><span class="line">mTimerSlack: 0.50ms mMinVsyncDistance: 3.00ms</span><br><span class="line">mIntendedWakeupTime: 9223132938240.00ms from now</span><br><span class="line">mLastTimerCallback: 3429.38ms ago mLastTimerSchedule: 3429.25ms ago</span><br><span class="line">Callbacks:</span><br><span class="line">app:</span><br><span class="line">mWorkDuration: 15.67ms mEarliestVsync: -3413.84ms relative to now</span><br><span class="line">mLastDispatchTime: 3413.84ms ago</span><br><span class="line">SamplingThreadDispSyncListener:</span><br><span class="line">mWorkDuration: 16.67ms mEarliestVsync: -36455.66ms relative to now</span><br><span class="line">mLastDispatchTime: 36455.66ms ago</span><br><span class="line">sf:</span><br><span class="line">mWorkDuration: 15.67ms mEarliestVsync: -3413.85ms relative to now</span><br><span class="line">mLastDispatchTime: 3413.85ms ago: mPeriod&#x3D;16.67 last vsync time</span><br><span class="line">-36455.65ms relative to now (stopped)</span><br><span class="line">sf: mPeriod&#x3D;16.67 last vsync time -3413.83ms relative to now (stopped)</span><br></pre></td></tr></table></figure>



<ul>
<li>屏幕静态帧信息。上面是每一帧的耗时情况。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Static screen stats:</span><br><span class="line">&lt; 1 frames: 27577.410 s (12.6%)</span><br><span class="line">&lt; 2 frames: 47824.660 s (21.8%)</span><br><span class="line">&lt; 3 frames: 25877.781 s (11.8%)</span><br><span class="line">&lt; 4 frames: 5652.359 s (2.6%)</span><br><span class="line">&lt; 5 frames: 1385.776 s (0.6%)</span><br><span class="line">&lt; 6 frames: 912.082 s (0.4%)</span><br><span class="line">&lt; 7 frames: 931.007 s (0.4%)</span><br><span class="line">7+ frames: 108752.281 s (49.7%)</span><br></pre></td></tr></table></figure>



<ul>
<li>掉帧的情况。总掉帧个数，HWC掉帧个数，GPU掉帧个数。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Synergy Status, secureProxy: 0</span><br><span class="line">Total missed frame count: 360454</span><br><span class="line">HWC missed frame count: 64126</span><br><span class="line">GPU missed frame count: 298980</span><br></pre></td></tr></table></figure>



<ul>
<li>Buffer信息。具体的参数定义：[Layer name] ，Active time ，Two buffer，Double buffered， Triple buffered。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Buffering stats:</span><br><span class="line">[Layer name] &lt;Active time&gt; &lt;Two buffer&gt; &lt;Double buffered&gt; &lt;Triple buffered&gt;</span><br><span class="line">[SurfaceView - com.aligames.sgzzlb.aligames&#x2F;com.ejoy2dx.s3client.S3Activity#0]</span><br><span class="line">47258.38 0.039 1.000 0.000</span><br><span class="line">[com.ss.android.ugc.aweme&#x2F;com.ss.android.ugc.aweme.splash.SplashActivity#0]</span><br><span class="line">19856.39 0.014 0.228 0.772</span><br><span class="line">[AOD#0] 6226.34 0.370 0.993 0.007</span><br><span class="line">[StatusBar#0] 5846.64 0.328 0.837 0.163</span><br><span class="line">[com.tencent.mm&#x2F;com.tencent.mm.ui.LauncherUI#0] 3699.43 0.158 0.858 0.142</span><br><span class="line">[InputMethod#0] 3372.82 0.253 0.571 0.429</span><br><span class="line">[com.tencent.mm&#x2F;com.tencent.mm.plugin.appbrand.ui.AppBrandUI#0] 2077.59 0.701</span><br><span class="line">0.917 0.083</span><br><span class="line">[co.azurestudios.frameskip&#x2F;co.azurestudios.frameskip.PlayerActivity#0] 1736.56</span><br><span class="line">0.000 0.008 0.992</span><br><span class="line">[com.miui.home&#x2F;com.miui.home.launcher.Launcher#0] 1718.09 0.282 0.684 0.316</span><br><span class="line">[com.tencent.mm&#x2F;com.tencent.mm.plugin.brandservice.ui.timeline.preload.ui.TmplWe</span><br><span class="line">bViewTooLMpUI#0] 1571.76 0.495 0.878 0.122</span><br><span class="line">[SurfaceView - com.android.incallui&#x2F;com.android.incallui.InCallActivity#0]</span><br><span class="line">1544.50 0.000 0.153 0.847</span><br><span class="line">[NavigationBar#0] 1351.26 0.801 0.906 0.094</span><br><span class="line">[com.huasheng.stock&#x2F;com.huasheng.stock.ui.MainActivity#0] 1337.62 0.296 0.381</span><br><span class="line">0.619</span><br><span class="line">[com.tencent.mm&#x2F;com.tencent.mm.plugin.appbrand.ui.AppBrandUI2#0] 999.80 0.726</span><br><span class="line">0.910 0.090</span><br><span class="line">[com.jingdong.app.mall&#x2F;com.jd.lib.ordercenter.logisticstrack.LogisticsTrackActiv</span><br><span class="line">ity#0] 948.23 0.043 0.989 0.011</span><br><span class="line">......</span><br></pre></td></tr></table></figure>



<ul>
<li><p>Visible layers (count = 95)：可见Layers，这里的Layers不一定是可见的。count的值来源于 layersSortedByZ中layer的数量，最大数量是4096； </p>
<p>buffer生产者个数，最大是4096； </p>
<p>后面是参与合成的Layer，这里会打印出LayerFECompositionState结构体 （frameworks/native/services/surfaceflinger/CompositionEngine/include/compositionengine/Lay erFECompositionState.h）的内容。 </p>
<p>0xb40000708322d000指向当前Layer对象的值，后面括号中是当前Layer的名称。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Visible layers (count &#x3D; 95)</span><br><span class="line">GraphicBufferProducers: 12, max 4096</span><br><span class="line">Composition layers</span><br><span class="line">* Layer 0xb40000708322d000 (com.android.systemui.ImageWallpaper#0)</span><br><span class="line">isSecure&#x3D;false geomUsesSourceCrop&#x3D;true</span><br><span class="line">geomBufferUsesDisplayInverseTransform&#x3D;false geomLayerTransform 0x00000000 (ROT_0</span><br><span class="line">) 0x00 (IDENTITY )</span><br><span class="line">1.0000 0.0000 0.0000</span><br><span class="line">0.0000 1.0000 0.0000</span><br><span class="line">0.0000 0.0000 1.0000</span><br><span class="line">geomBufferSize&#x3D;[0 0 1080 2400] geomContentCrop&#x3D;[0 0 1080 2400] geomCrop&#x3D;[0</span><br><span class="line">0 -1 -1] geomBufferTransform&#x3D;0</span><br><span class="line">Region transparentRegionHint (this&#x3D;0xb400007083241e88, count&#x3D;1)</span><br><span class="line">[ 0, 0, 0, 0]</span><br><span class="line">geomLayerBounds&#x3D;[0.000000 0.000000 1080.000000 2400.000000]</span><br><span class="line">shadowRadius&#x3D;0.000000</span><br><span class="line">blend&#x3D;NONE (1) alpha&#x3D;1.000000 backgroundBlurRadius&#x3D;0</span><br><span class="line">type&#x3D;2013 appId&#x3D;1000 composition type&#x3D;DEVICE (2)</span><br><span class="line">buffer: slot&#x3D;0 buffer&#x3D;0xb4000070729f6200</span><br><span class="line">sideband stream&#x3D;0x0</span><br><span class="line">color&#x3D;[0.000000 0.000000 0.000000]</span><br><span class="line">isOpaque&#x3D;true hasProtectedContent&#x3D;false isColorspaceAgnostic&#x3D;false</span><br><span class="line">dataspace&#x3D;UNKNOWN (0) hdr metadata types&#x3D;0 colorTransform&#x3D;</span><br><span class="line">[[1.000,0.000,0.000,0.000][0.000,1.000,0.000,0.000][0.000,0.000,1.000,0.000]</span><br><span class="line">[0.000,0.000,0.000,1.000]]</span><br><span class="line">.....</span><br></pre></td></tr></table></figure>



<ul>
<li>打印Display的信息。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">Displays (1 entries)</span><br><span class="line">+ DisplayDevice&#123;19260810807042689, internal, primary, &quot;&quot;&#125;</span><br><span class="line">powerMode&#x3D;On (2), activeConfig&#x3D;0, mIsScreenProjection&#x3D;0, Composition</span><br><span class="line">Display State: [&quot;&quot;]</span><br><span class="line">isVirtual&#x3D;false hwcId&#x3D;19260810807042689</span><br><span class="line">isEnabled&#x3D;true isSecure&#x3D;true usesClientComposition&#x3D;false</span><br><span class="line">usesDeviceComposition&#x3D;true flipClientTarget&#x3D;false reusedClientComposition&#x3D;false</span><br><span class="line">layerStack&#x3D;0 layerStackInternal&#x3D;true</span><br><span class="line">transform 0x00000000 (ROT_0 ) 0x00 (IDENTITY )</span><br><span class="line">1.0000 0.0000 -0.0000</span><br><span class="line">0.0000 1.0000 -0.0000</span><br><span class="line">0.0000 0.0000 1.0000</span><br><span class="line">bounds&#x3D;[0 0 1080 2400] frame&#x3D;[0 0 1080 2400] viewport&#x3D;[0 0 1080 2400]</span><br><span class="line">sourceClip&#x3D;[0 0 1080 2400] destinationClip&#x3D;[0 0 1080 2400] needsFiltering&#x3D;false</span><br><span class="line">colorMode&#x3D;SRGB (7) renderIntent&#x3D;0x102 (258) dataspace&#x3D;V0_SRGB (142671872)</span><br><span class="line">colorTransformMatrix&#x3D;[[1.000,0.000,0.000,0.000][0.000,1.000,0.000,0.000]</span><br><span class="line">[0.000,0.000,1.000,0.000][0.000,0.000,0.000,1.000]]target dataspace&#x3D;V0_SRGB</span><br><span class="line">(142671872)</span><br><span class="line">Composition Display Color State:</span><br><span class="line">HWC Support: wideColorGamut&#x3D;true hdr10plus&#x3D;true hdr10&#x3D;true hlg&#x3D;true dv&#x3D;false</span><br><span class="line">metadata&#x3D;7</span><br><span class="line">Composition RenderSurface State:</span><br><span class="line">size&#x3D;[1080 2400] ANativeWindow&#x3D;0xb40000710a98e010 (format 1) flips&#x3D;4837726</span><br><span class="line">FramebufferSurface: dataspace: Default(0)</span><br><span class="line">mAbandoned&#x3D;0</span><br><span class="line">- BufferQueue mMaxAcquiredBufferCount&#x3D;2 mMaxDequeuedBufferCount&#x3D;1</span><br><span class="line">mDequeueBufferCannotBlock&#x3D;0 mAsyncMode&#x3D;0</span><br><span class="line">mQueueBufferCanDrop&#x3D;0 mLegacyBufferDrop&#x3D;1</span><br><span class="line">default-size&#x3D;[1080x2400] default-format&#x3D;1 transform-hint&#x3D;00 framecounter&#x3D;534105</span><br><span class="line">mTransformHintInUse&#x3D;00 mAutoPrerotation&#x3D;0</span><br><span class="line">FIFO(0):</span><br><span class="line">(mConsumerName&#x3D;FramebufferSurface, mConnectedApi&#x3D;1, mConsumerUsageBits&#x3D;6656,</span><br><span class="line">mId&#x3D;3df00000000, producer&#x3D;[944:???], consumer&#x3D;[991:&#x2F;system&#x2F;bin&#x2F;surfaceflinger])</span><br><span class="line">Slots:</span><br><span class="line">&gt;[00:0xb40000707dbd4400] state&#x3D;ACQUIRED 0xb40000710a899970 frame&#x3D;534105</span><br><span class="line">[1080x2400:1088, 1]</span><br><span class="line">[02:0xb40000707dbd4600] state&#x3D;FREE 0xb40000710a899a50 frame&#x3D;534103</span><br><span class="line">[1080x2400:1088, 1]</span><br><span class="line">[01:0xb40000707dbd4500] state&#x3D;FREE 0xb40000710a8999e0 frame&#x3D;534104</span><br><span class="line">[1080x2400:1088, 1]</span><br></pre></td></tr></table></figure>



<ul>
<li><p>这里是OutputLayerCompositionState结构的内容打印。 </p>
<p>visibleRegion：未被顶部不透明图层遮挡的图层部分； </p>
<p>visibleNonTransparentRegion：图层中未被遮挡且不透明的部分 ；</p>
<p>coveredRegion：被顶部不透明层遮挡的层部分； </p>
<p>output visibleRegion：可见区域转化为输出空间； </p>
<p>shadowRegion：图层阴影投射的区域； </p>
<p>displayFrame：此输出上此图层的显示帧；</p>
<p>hwc：HWC状态；</p>
<p>layer：支持这一层的HWC层；</p>
<p>0x08541a：底层hwcomposer创建layer的句柄；</p>
<p>composition：该层设置的HWC合成类型，这里是DEVICE，value=2，意思是通过硬件来合成。 </p>
<p><strong>PS：HWC composition type</strong></p>
</li>
</ul>
<p>&emsp;&emsp;定义在：IComposerClient.h中。一共有五个值，分别为： </p>
<p>INVALID(0)：无效的； </p>
<p>CLIENT(1)：客户端必须将此层合成到客户端目标缓冲区中； </p>
<p>DEVICE(2)：设备必须通过硬件叠加或其他类似方式来处理这一层的组成；</p>
<p>SOLID_COLOR(3)：设备必须使用通过设置的颜色渲染此层设置图层颜色。 如果图层不支持此功能 客户端设置为 SOLID_COLOR，设备必须请求该层的组合类型更改为 CLIENT；</p>
<p>CURSOR(4)：与DEVICE相似，但也可以设置该层的位置； </p>
<p>SIDEBAND(5)：设备必须处理这一层的组成，以及它的缓冲区更新和内容同步。 仅支持提供 Capability::SIDEBAND_STREAM 的设备； </p>
<p>Device表示GSP或者是DPU合成，Client表示的是GPU合成，一般gsp/dpu合成可以更加省电。 何时使用gpu合成何时使用gsp/dpu合成 </p>
<p>1、首先看硬件能力，比如gsp 有4层，支持2层缩放/旋转。 dpu 有8层，支持输入旋转 </p>
<p>2、首选dpu ，再选dpu和gsp混合合成 ，再选gsp ，最后选择gsp </p>
<p>3、查看图像的合成信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">5 Layers</span><br><span class="line">- Output Layer</span><br><span class="line">0xb4000070728d8700(com.tencent.mm&#x2F;com.tencent.mm.ui.LauncherUI#0)</span><br><span class="line">Region visibleRegion (this&#x3D;0xb4000070728d8718, count&#x3D;1)</span><br><span class="line">[ 0, 0, 1080, 2400]</span><br><span class="line">Region visibleNonTransparentRegion (this&#x3D;0xb4000070728d8780, count&#x3D;1)</span><br><span class="line">[ 0, 0, 1080, 2400]</span><br><span class="line">Region coveredRegion (this&#x3D;0xb4000070728d87e8, count&#x3D;2)</span><br><span class="line">[ 0, 0, 1080, 198]</span><br><span class="line">[ 0, 2202, 1080, 2400]</span><br><span class="line">Region output visibleRegion (this&#x3D;0xb4000070728d8850, count&#x3D;1)</span><br><span class="line">[ 0, 0, 1080, 2400]</span><br><span class="line">Region shadowRegion (this&#x3D;0xb4000070728d88b8, count&#x3D;1)</span><br><span class="line">[ 0, 0, 0, 0]</span><br><span class="line">forceClientComposition&#x3D;false clearClientTarget&#x3D;false displayFrame&#x3D;[0 0 1080</span><br><span class="line">2400] sourceCrop&#x3D;[0.000000 0.000000 1080.000000 2400.000000] bufferTransform&#x3D;0</span><br><span class="line">(0) dataspace&#x3D;UNKNOWN (0) z-index&#x3D;0</span><br><span class="line">hwc: layer&#x3D;0x08541a composition&#x3D;DEVICE (2)</span><br><span class="line">......</span><br></pre></td></tr></table></figure>



<ul>
<li><p>打印出SurfaceFlinger全局信息。 </p>
<p>比如：EGL implementation（EGL版本）：v1.5； </p>
<p>GPU的型号：Qualcomm, Adreno (TM) 650； </p>
<p>OpenGL的版本：OpenGL ES 3.2 <a href="mailto:&#x56;&#x40;&#x30;&#x35;&#48;&#x32;&#46;&#x30;">&#x56;&#x40;&#x30;&#x35;&#48;&#x32;&#46;&#x30;</a>； </p>
<p>EGL_KHR_image/EGL_KHR_surfaceless_context：支持的EGL库； </p>
<p>GL_EXT_texture_format_BGRA8888/GL_EXT_texture_type_2_10_10_10_REV：支持的GL库； </p>
<p>Region undefinedRegion ：屏幕宽高（1080，2400）; </p>
<p>orientation：屏幕方向，竖屏； </p>
<p>refresh-rate：屏幕刷新率60fps； </p>
<p>x-dpi/y-dpi：屏幕密度：394</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">SurfaceFlinger global state:</span><br><span class="line">EGL implementation : 1.5</span><br><span class="line">EGL_KHR_image EGL_KHR_image_base EGL_QCOM_create_image EGL_KHR_lock_surface</span><br><span class="line">EGL_KHR_lock_surface2 EGL_KHR_lock_surface3 EGL_KHR_gl_texture_2D_image</span><br><span class="line">EGL_KHR_gl_texture_cubemap_image EGL_KHR_gl_texture_3D_image</span><br><span class="line">EGL_KHR_gl_renderbuffer_image EGL_ANDROID_blob_cache EGL_KHR_create_context</span><br><span class="line">EGL_KHR_surfaceless_context EGL_KHR_create_context_no_error</span><br><span class="line">EGL_KHR_get_all_proc_addresses EGL_QCOM_lock_image2 EGL_EXT_protected_content</span><br><span class="line">EGL_KHR_no_config_context EGL_EXT_surface_SMPTE2086_metadata</span><br><span class="line">EGL_ANDROID_recordable EGL_ANDROID_native_fence_sync</span><br><span class="line">EGL_ANDROID_image_native_buffer EGL_ANDROID_framebuffer_target</span><br><span class="line">EGL_EXT_create_context_robustness EGL_EXT_pixel_format_float EGL_EXT_yuv_surface</span><br><span class="line">EGL_IMG_context_priority EGL_IMG_image_plane_attribs EGL_KHR_cl_event</span><br><span class="line">EGL_KHR_cl_event2 EGL_KHR_fence_sync EGL_KHR_gl_colorspace</span><br><span class="line">EGL_EXT_image_gl_colorspace EGL_KHR_mutable_render_buffer EGL_KHR_partial_update</span><br><span class="line">EGL_KHR_reusable_sync EGL_KHR_wait_sync EGL_QCOM_gpu_perf</span><br><span class="line">GLES: Qualcomm, Adreno (TM) 650, OpenGL ES 3.2 V@0502.0 (GIT@191610ae03,</span><br><span class="line">Ic907de5ed0, 1600323700) (Date:09&#x2F;17&#x2F;20)</span><br><span class="line">GL_OES_EGL_image GL_OES_EGL_image_external GL_OES_EGL_sync</span><br><span class="line">GL_OES_vertex_half_float GL_OES_framebuffer_object GL_OES_rgb8_rgba8</span><br><span class="line">GL_OES_compressed_ETC1_RGB8_texture GL_AMD_compressed_ATC_texture</span><br><span class="line">GL_KHR_texture_compression_astc_ldr GL_KHR_texture_compression_astc_hdr</span><br><span class="line">GL_OES_texture_compression_astc GL_OES_texture_npot</span><br><span class="line">GL_EXT_texture_filter_anisotropic GL_EXT_texture_format_BGRA8888</span><br><span class="line">GL_EXT_read_format_bgra GL_OES_texture_3D GL_EXT_color_buffer_float</span><br><span class="line">GL_EXT_color_buffer_half_float GL_QCOM_alpha_test GL_OES_depth24</span><br><span class="line">GL_OES_packed_depth_stencil GL_OES_depth_texture GL_OES_depth_texture_cube_map</span><br><span class="line">GL_EXT_sRGB GL_OES_texture_float GL_OES_texture_float_linear</span><br><span class="line">GL_OES_texture_half_float GL_OES_texture_half_float_linear</span><br><span class="line">GL_EXT_texture_type_2_10_10_10_REV GL_EXT_texture_sRGB_decode</span><br><span class="line">GL_EXT_texture_format_sRGB_override GL_OES_element_index_uint GL_EXT_copy_image</span><br><span class="line">GL_EXT_geometry_shader GL_EXT_tessellation_shader GL_OES_texture_stencil8</span><br><span class="line">GL_EXT_shader_io_blocks GL_OES_shader_image_atomic GL_OES_sample_variables</span><br><span class="line">GL_EXT_texture_border_clamp GL_EXT_EGL_image_external_wrap_modes</span><br><span class="line">GL_EXT_multisampled_render_to_texture GL_EXT_multisampled_render_to_texture2</span><br><span class="line">GL_OES_shader_multisample_interpolation GL_EXT_texture_cube_map_array</span><br><span class="line">GL_EXT_draw_buffers_indexed GL_EXT_gpu_shader5 GL_EXT_robustness</span><br><span class="line">GL_EXT_texture_buffer GL_EXT_shader_framebuffer_fetch</span><br><span class="line">GL_ARM_shader_framebuffer_fetch_depth_stencil</span><br><span class="line">GL_OES_texture_storage_multisample_2d_array GL_OES_sample_shading</span><br><span class="line">GL_OES_get_program_binary GL_EXT_debug_label GL_KHR_blend_equation_advanced</span><br><span class="line">GL_KHR_blend_equation_advanced_coherent GL_QCOM_tiled_rendering</span><br><span class="line">GL_ANDROID_extension_pack_es31a GL_EXT_primitive_bounding_box</span><br><span class="line">GL_OES_standard_derivatives GL_OES_vertex_array_object</span><br><span class="line">GL_EXT_disjoint_timer_query GL_KHR_debug GL_EXT_YUV_target</span><br><span class="line">GL_EXT_sRGB_write_control GL_EXT_texture_norm16 GL_EXT_discard_framebuffer</span><br><span class="line">GL_OES_surfaceless_context GL_OVR_multiview GL_OVR_multiview2</span><br><span class="line">GL_EXT_texture_sRGB_R8 GL_KHR_no_error GL_EXT_debug_marker</span><br><span class="line">GL_OES_EGL_image_external_essl3 GL_OVR_multiview_multisampled_render_to_texture</span><br><span class="line">GL_EXT_buffer_storage GL_EXT_external_buffer GL_EXT_blit_framebuffer_params</span><br><span class="line">GL_EXT_clip_cull_distance GL_EXT_protected_textures</span><br><span class="line">GL_EXT_shader_non_constant_global_initializers GL_QCOM_texture_foveated</span><br><span class="line">GL_QCOM_texture_foveated_subsampled_layout</span><br><span class="line">GL_QCOM_shader_framebuffer_fetch_noncoherent</span><br><span class="line">GL_QCOM_shader_framebuffer_fetch_rate GL_EXT_memory_object</span><br><span class="line">GL_EXT_memory_object_fd GL_EXT_EGL_image_array</span><br><span class="line">GL_NV_shader_noperspective_interpolation GL_KHR_robust_buffer_access_behavior</span><br><span class="line">GL_EXT_EGL_image_storage GL_EXT_blend_func_extended GL_EXT_clip_control</span><br><span class="line">GL_OES_texture_view GL_EXT_fragment_invocation_density GL_QCOM_motion_estimation</span><br><span class="line">GL_QCOM_validate_shader_binary GL_QCOM_YUV_texture_gather</span><br><span class="line">RenderEngine supports protected context: 1</span><br><span class="line">RenderEngine is in protected context: 0</span><br><span class="line">RenderEngine program cache size for unprotected context: 74</span><br><span class="line">RenderEngine program cache size for protected context: 0</span><br><span class="line">RenderEngine last dataspace conversion: (Default) to (BT709 sRGB Full range)</span><br><span class="line">RenderEngine image cache size: 14</span><br><span class="line">Dumping buffer ids...</span><br><span class="line">0x3df003451ea</span><br><span class="line">0x3df003451e2</span><br><span class="line">0x3df00344e0d</span><br><span class="line">0x3df003447bc</span><br><span class="line">0x3df0032df6d</span><br><span class="line">0x3df00344dd3</span><br><span class="line">0x3df0032db84</span><br><span class="line">0x3df0032d4ab</span><br><span class="line">0x3df0032d463</span><br><span class="line">0x3df0032d41b</span><br><span class="line">0x3df0032d417</span><br><span class="line">0x3df0032d401</span><br><span class="line">0x3df0030f540</span><br><span class="line">0x3df0030a4e2</span><br><span class="line">RenderEngine framebuffer image cache size: 3</span><br><span class="line">Dumping buffer ids...</span><br><span class="line">0x3df00000002</span><br><span class="line">0x3df00000001</span><br><span class="line">0x3df00000000</span><br><span class="line">Region undefinedRegion (this&#x3D;0xb40000710aa27a98, count&#x3D;1)</span><br><span class="line">[ 0, 0, 1080, 2400]</span><br><span class="line">orientation&#x3D;ROTATION_0, isPoweredOn&#x3D;1</span><br><span class="line">transaction-flags : 00000000</span><br><span class="line">gpu_to_cpu_unsupported : 0</span><br><span class="line">refresh-rate : 60.000002 fps</span><br><span class="line">x-dpi : 394.704987</span><br><span class="line">y-dpi : 394.562988</span><br><span class="line">transaction time: 0.000000 us</span><br><span class="line">Tracing state: disabled</span><br><span class="line">number of entries: 0 (0.00MB &#x2F; 0.00MB)</span><br></pre></td></tr></table></figure>



<ul>
<li>参与合成的layer信息。可以看到一共有几层图像，每层图像的合成方式（Comp Type）,窗口的类型 （Window Type）等。这个地方是一个比较重要的点。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">Display 19260810807042689 HWC layers:</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">Layer name</span><br><span class="line">Z | Window Type | Layer Class | Comp Type | Transform | Disp</span><br><span class="line">Frame (LTRB) | Source Crop (LTRB) | Frame Rate (Explicit) [Focused]</span><br><span class="line">---------------------------------------------------------------------------------</span><br><span class="line">--------------------------------------------------------------</span><br><span class="line">com.tencent.mm&#x2F;com.tencent.mm.ui.LauncherUI#0</span><br><span class="line">rel 0 | 1 | 0 | DEVICE | 0 | 0 0</span><br><span class="line">1080 2400 | 0.0 0.0 1080.0 2400.0 | [*]</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">StatusBar#0</span><br><span class="line">rel 0 | 2000 | 0 | DEVICE | 0 | 0 0</span><br><span class="line">1080 96 | 0.0 0.0 1080.0 96.0 | [ ]</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">NavigationBar#0</span><br><span class="line">rel 0 | 2019 | 0 | DEVICE | 0 | 0 2270</span><br><span class="line">1080 2400 | 0.0 0.0 1080.0 130.0 | [ ]</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">RoundCorner#0</span><br><span class="line">rel 0 | 2024 | 0 | DEVICE | 0 | 0 0</span><br><span class="line">1080 198 | 0.0 0.0 1080.0 198.0 | [ ]</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">RoundCorner#1</span><br><span class="line">rel 0 | 2024 | 0 | DEVICE | 0 | 0 2202</span><br><span class="line">1080 2400 | 0.0 0.0 1080.0 198.0 | [ ]</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<ul>
<li>hwc合成的状态，enabled：开启。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">h&#x2F;w composer state:</span><br><span class="line">h&#x2F;w composer enabled</span><br></pre></td></tr></table></figure>



<ul>
<li>HWC信息、Color Modes信息、SDM（高通采用的）等。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line">------------HWC----------------</span><br><span class="line">HWC2 display_id: 0</span><br><span class="line">layer: 21530 z: 0 composition: Device&#x2F;Device alpha: 255 format:</span><br><span class="line">RGBA_8888_UBWC dataspace:0x00000000 transform: 0&#x2F;0&#x2F;0 buffer_id:</span><br><span class="line">0xb400007633613770 secure: 0</span><br><span class="line">layer: 21504 z: 1 composition: Device&#x2F;Device alpha: 255 format:</span><br><span class="line">RGBA_8888_UBWC dataspace:0x00000000 transform: 0&#x2F;0&#x2F;0 buffer_id:</span><br><span class="line">0xb400007633613690 secure: 0</span><br><span class="line">layer: 21401 z: 2 composition: Device&#x2F;Device alpha: 255 format:</span><br><span class="line">RGBA_8888_UBWC dataspace:0x00000000 transform: 0&#x2F;0&#x2F;0 buffer_id:</span><br><span class="line">0xb400007633613070 secure: 0</span><br><span class="line">layer: 20804 z: 3 composition: Device&#x2F;Device alpha: 255 format:</span><br><span class="line">RGBA_8888_UBWC dataspace:0x00000000 transform: 0&#x2F;0&#x2F;0 buffer_id:</span><br><span class="line">0xb400007633613620 secure: 0</span><br><span class="line">layer: 20803 z: 4 composition: Device&#x2F;Device alpha: 255 format:</span><br><span class="line">RGBA_8888_UBWC dataspace:0x00000000 transform: 0&#x2F;0&#x2F;0 buffer_id:</span><br><span class="line">0xb4000076336138c0 secure: 0</span><br><span class="line">----------Color Modes---------</span><br><span class="line">color modes supported:</span><br><span class="line">mode: 0 RIs &#123; 0 dynamic_range [ 0 ] 1 dynamic_range [ 0 ] 2 dynamic_range [ 0 ] 3</span><br><span class="line">dynamic_range [ 0 ] &#125;</span><br><span class="line">mode: 7 RIs &#123; 0 dynamic_range [ 0 ] 1 dynamic_range [ 0 ] 2 dynamic_range [ 0 ] 3</span><br><span class="line">dynamic_range [ 0 ] 256 dynamic_range [ 0 ] 257 dynamic_range [ 0 ] 258</span><br><span class="line">dynamic_range [ 0 ] 259 dynamic_range [ 0 ] 260 dynamic_range [ 0 ] 261</span><br><span class="line">dynamic_range [ 0 ] 262 dynamic_range [ 0 ] 263 dynamic_range [ 0 ] 264</span><br><span class="line">dynamic_range [ 0 ] 265 dynamic_range [ 0 ] 266 dynamic_range [ 0 ] 267</span><br><span class="line">dynamic_range [ 0 ] 268 dynamic_range [ 0 ] 269 dynamic_range [ 0 ] 270</span><br><span class="line">dynamic_range [ 0 ] &#125;</span><br><span class="line">mode: 9 RIs &#123; 0 dynamic_range [ 0 1 ] 1 dynamic_range [ 0 1 ] 2 dynamic_range [ 0</span><br><span class="line">1 ] 3 dynamic_range [ 0 1 ] 256 dynamic_range [ 0 ] 257 dynamic_range [ 0 ] 258</span><br><span class="line">dynamic_range [ 0 ] 259 dynamic_range [ 0 ] 260 dynamic_range [ 0 ] 261</span><br><span class="line">dynamic_range [ 0 ] 262 dynamic_range [ 0 ] 263 dynamic_range [ 0 ] 264</span><br><span class="line">dynamic_range [ 0 ] 265 dynamic_range [ 0 ] 266 dynamic_range [ 0 ] 267</span><br><span class="line">dynamic_range [ 0 ] 268 dynamic_range [ 0 ] 269 dynamic_range [ 0 ] 270</span><br><span class="line">dynamic_range [ 0 ] &#125;</span><br><span class="line">current mode: 7</span><br><span class="line">current render_intent: 258</span><br><span class="line">current dynamic_range: SDR</span><br><span class="line">current transform:</span><br><span class="line">0.92 -0.00 -0.00 0.00</span><br><span class="line">0.08 0.85 -0.01 0.00</span><br><span class="line">0.01 0.00 0.69 0.00</span><br><span class="line">0.00 0.00 0.00 1.00</span><br><span class="line">------------SDM----------------</span><br><span class="line">device type:0</span><br><span class="line">state: 1 vsync on: 0 max. mixer stages: 11</span><br><span class="line">num configs: 1 active config index: 0</span><br><span class="line">Display Attributes:</span><br><span class="line">Mode:Command Primary:true DynFPS:false</span><br><span class="line">HDR Panel:true QSync:false DynBitclk:false</span><br><span class="line">Left Split:1080 Right Split:0</span><br><span class="line">PartialUpdate:false</span><br><span class="line">FPS min:60 max:60 cur:60 TransferTime: 14060us MaxBrightness:2047</span><br><span class="line">Display WxH: 1080x2400 MixerWxH: 1080x2400 DPI: 394.705x394.563 LM_Split: false</span><br><span class="line">vsync_period 16666666 v_back_porch: 34 v_front_porch: 34 v_pulse_width: 20</span><br><span class="line">v_total: 2488 h_total: 1228 clk: 184345 Topology: 1</span><br><span class="line">Current Color Mode: smart_MC</span><br><span class="line">Available Color Modes:</span><br><span class="line">GM_1 30 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: GM_1 RenderIntent: 263</span><br><span class="line">GM_11 31 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: GM_11 RenderIntent: 263</span><br><span class="line">GM_2 32 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: GM_2 RenderIntent: 264</span><br><span class="line">GM_22 33 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: GM_22 RenderIntent: 264</span><br><span class="line">GM_3 34 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: GM_3 RenderIntent: 265</span><br><span class="line">GM_33 35 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: GM_33 RenderIntent: 265</span><br><span class="line">enhanced 1 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: enhanced RenderIntent: 1</span><br><span class="line">enhanced_hdr 9 DynamicRange: hdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: enhanced RenderIntent: 1</span><br><span class="line">enhanced_native 13 DynamicRange: sdr ColorGamut: native</span><br><span class="line">PictureQuality: enhanced RenderIntent: 1</span><br><span class="line">enhanced_p3 5 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: enhanced RenderIntent: 1</span><br><span class="line">expert_dcip3 40 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: expert_dcip3 RenderIntent: 268</span><br><span class="line">expert_dcip3_1 41 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: expert_dcip3_1 RenderIntent: 268</span><br><span class="line">expert_native 36 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: expert_native RenderIntent: 266</span><br><span class="line">expert_native1 37 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: expert_native1 RenderIntent: 266</span><br><span class="line">expert_srgb 38 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: expert_srgb RenderIntent: 267</span><br><span class="line">expert_srgb1 39 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: expert_srgb1 RenderIntent: 267</span><br><span class="line">expert_transition 44 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: expert_transition RenderIntent: 270</span><br><span class="line">expert_transition1 45 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: expert_transition1 RenderIntent: 270</span><br><span class="line">expert_wcg_dcip3 43 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: expert_wcg_dcip3 RenderIntent: 269</span><br><span class="line">expert_wcg_srgb 42 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: expert_wcg_srgb RenderIntent: 269</span><br><span class="line">hal_dcip3 19 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: hal_dcip3 RenderIntent: 257</span><br><span class="line">hal_native 16 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: hal_native RenderIntent: 256</span><br><span class="line">hal_native1 17 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: hal_native1 RenderIntent: 256</span><br><span class="line">hal_srgb 18 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: hal_srgb RenderIntent: 257</span><br><span class="line">smart_MC 20 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: smart_MC RenderIntent: 258</span><br><span class="line">smart_MC1 21 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: smart_MC1 RenderIntent: 258</span><br><span class="line">standard 0 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: standard RenderIntent: 0</span><br><span class="line">standard_hdr 8 DynamicRange: hdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: standard RenderIntent: 0</span><br><span class="line">standard_native 12 DynamicRange: sdr ColorGamut: native</span><br><span class="line">PictureQuality: standard RenderIntent: 0</span><br><span class="line">standard_p3 4 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: standard RenderIntent: 0</span><br><span class="line">video1 22 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: video1 RenderIntent: 259</span><br><span class="line">video11 23 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: video11 RenderIntent: 259</span><br><span class="line">video2 24 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: video2 RenderIntent: 260</span><br><span class="line">video22 25 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: video22 RenderIntent: 260</span><br><span class="line">video3 26 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: video3 RenderIntent: 261</span><br><span class="line">video33 27 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: video33 RenderIntent: 261</span><br><span class="line">video4 28 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: video4 RenderIntent: 262</span><br><span class="line">video44 29 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: video44 RenderIntent: 262</span><br><span class="line">vivid 2 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: vivid RenderIntent: 2</span><br><span class="line">vivid_hdr 10 DynamicRange: hdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: vivid RenderIntent: 2</span><br><span class="line">vivid_native 14 DynamicRange: sdr ColorGamut: native</span><br><span class="line">PictureQuality: vivid RenderIntent: 2</span><br><span class="line">vivid_p3 6 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: vivid RenderIntent: 2</span><br><span class="line">warm 3 DynamicRange: sdr ColorGamut: srgb</span><br><span class="line">PictureQuality: warm RenderIntent: 3</span><br><span class="line">warm_hdr 11 DynamicRange: hdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: warm RenderIntent: 3</span><br><span class="line">warm_native 15 DynamicRange: sdr ColorGamut: native</span><br><span class="line">PictureQuality: warm RenderIntent: 3</span><br><span class="line">warm_p3 7 DynamicRange: sdr ColorGamut: dcip3</span><br><span class="line">PictureQuality: warm RenderIntent: 3</span><br><span class="line">ROI(LTRB)#0 LEFT(0 0 1080 2400)</span><br><span class="line">|-----|---------------|-----------|------|-------------|-------------------------</span><br><span class="line">-|---------------------|---------------------|----|------------|-----------|----</span><br><span class="line">|-----|----|</span><br><span class="line">| Idx | Comp Type | Split | Pipe | W x H | Format</span><br><span class="line">| Src Rect (L T R B) | Dst Rect (L T R B) | Z | Pipe Flags | Deci(HxV) | CS |</span><br><span class="line">Rng | Tr |</span><br><span class="line">|-----|---------------|-----------|------|-------------|-------------------------</span><br><span class="line">-|---------------------|---------------------|----|------------|-----------|----</span><br><span class="line">|-----|----|</span><br><span class="line">| 0 | SDE | Pipe-1 | 100 | 1088 x 2400 | RGBA_8888_UBWC</span><br><span class="line">| 0 0 540 2400 | 0 0 540 2400 | 0 | 0x00000006 | 0 x 0 | 1 |</span><br><span class="line">0 | 1 |</span><br><span class="line">| | | Pipe-2 | 113 | 1088 x 2400 | RGBA_8888_UBWC</span><br><span class="line">| 540 0 1080 2400 | 540 0 1080 2400 | 0 | 0x00000006 | 0 x 0 | 1 |</span><br><span class="line">0 | 1 |</span><br><span class="line">| 1 | SDE | Pipe-1 | 97 | 1088 x 96 | RGBA_8888_UBWC</span><br><span class="line">| 0 0 540 96 | 0 0 540 96 | 1 | 0x00000006 | 0 x 0 | 1 |</span><br><span class="line">0 | 1 |</span><br><span class="line">| | | Pipe-2 | 110 | 1088 x 96 | RGBA_8888_UBWC</span><br><span class="line">| 540 0 1080 96 | 540 0 1080 96 | 1 | 0x00000007 | 0 x 0 | 1 |</span><br><span class="line">0 | 1 |</span><br><span class="line">| 2 | SDE | Pipe-1 | 94 | 1088 x 144 | RGBA_8888_UBWC</span><br><span class="line">| 0 0 540 130 | 0 2270 540 2400 | 2 | 0x00000006 | 0 x 0 | 1 |</span><br><span class="line">0 | 1 |</span><br><span class="line">| | | Pipe-2 | 107 | 1088 x 144 | RGBA_8888_UBWC</span><br><span class="line">| 540 0 1080 130 | 540 2270 1080 2400 | 2 | 0x00000007 | 0 x 0 | 1 |</span><br><span class="line">0 | 1 |</span><br><span class="line">| 3 | SDE | Pipe-1 | 88 | 1088 x 208 | RGBA_8888_UBWC</span><br><span class="line">| 0 0 540 198 | 0 0 540 198 | 3 | 0x00000006 | 0 x 0 | 1 |</span><br><span class="line">0 | 1 |</span><br><span class="line">| | | Pipe-2 | 103 | 1088 x 208 | RGBA_8888_UBWC</span><br><span class="line">| 540 0 1080 198 | 540 0 1080 198 | 3 | 0x00000007 | 0 x 0 | 1 |</span><br><span class="line">0 | 1 |</span><br><span class="line">| 4 | SDE | Pipe-1 | 85 | 1088 x 208 | RGBA_8888_UBWC</span><br><span class="line">| 0 0 540 198 | 0 2202 540 2400 | 4 | 0x00000006 | 0 x 0 | 1 |</span><br><span class="line">0 | 1 |</span><br><span class="line">| | | Pipe-2 | 125 | 1088 x 208 | RGBA_8888_UBWC</span><br><span class="line">| 540 0 1080 198 | 540 2202 1080 2400 | 4 | 0x00000007 | 0 x 0 | 1 |</span><br><span class="line">0 | 1 |</span><br><span class="line">|-----|---------------|-----------|------|-------------|-------------------------</span><br><span class="line">-|---------------------|---------------------|----|------------|-----------|----</span><br><span class="line">|-----|----|</span><br><span class="line">Color Sampling, dark (0.0) to light (1.0): sampled frames: 0</span><br><span class="line">no color statistics collected</span><br></pre></td></tr></table></figure>



<ul>
<li><p>GraphicBufferAllocator buffers图像缓存区信息，包括分配的内存大小，宽高，buffer申请者等。 </p>
<p>Imported gralloc buffers 导入到gralloc的缓存信息，包括宽高，size大小等。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line">------------Active Fences Info---------</span><br><span class="line">---------------------------------------</span><br><span class="line">GraphicBufferAllocator buffers:</span><br><span class="line">0xb400007070120790: 408.00 KiB | 1080 (1088) x 96 | 1 | 1 |</span><br><span class="line">0x10000900 | StatusBar#0</span><br><span class="line">0xb400007070130000: 841.50 KiB | 1080 (1088) x 198 | 1 | 1 |</span><br><span class="line">0x10000900 | RoundCorner#0</span><br><span class="line">0xb400007070131110: 408.00 KiB | 1080 (1088) x 96 | 1 | 1 | 0x203 |</span><br><span class="line">RegionSamplingThread</span><br><span class="line">0xb400007070131b20: 408.00 KiB | 1080 (1088) x 96 | 1 | 1 |</span><br><span class="line">0x10000900 | StatusBar#0</span><br><span class="line">0xb400007070131b90: 552.50 KiB | 1080 (1088) x 130 | 1 | 1 |</span><br><span class="line">0x10000900 | NavigationBar#0</span><br><span class="line">0xb400007070132220: 552.50 KiB | 1080 (1088) x 130 | 1 | 1 |</span><br><span class="line">0x10000900 | NavigationBar#0</span><br><span class="line">0xb400007070132990: 10260.00 KiB | 2400 (2432) x 1080 | 1 | 1 |</span><br><span class="line">0x10000900 | MiuiPaperContrastOverlay#0</span><br><span class="line">0xb400007070132a70: 408.00 KiB | 1080 (1088) x 96 | 1 | 1 |</span><br><span class="line">0x10000900 | StatusBar#0</span><br><span class="line">0xb4000070701335d0: 552.50 KiB | 1080 (1088) x 130 | 1 | 1 |</span><br><span class="line">0x10000900 | NavigationBar#0</span><br><span class="line">0xb400007070133790: 841.50 KiB | 1080 (1088) x 198 | 1 | 1 |</span><br><span class="line">0x10000900 | RoundCorner#0</span><br><span class="line">0xb400007070134280: 841.50 KiB | 1080 (1088) x 198 | 1 | 1 |</span><br><span class="line">0x10000900 | RoundCorner#1</span><br><span class="line">0xb400007070134670: 10200.00 KiB | 1080 (1088) x 2400 | 1 | 1 |</span><br><span class="line">0x10000900 | com.tencent.mm&#x2F;com.tencent.mm.ui.LauncherUI#0</span><br><span class="line">0xb400007072b6ada0: 841.50 KiB | 1080 (1088) x 198 | 1 | 1 |</span><br><span class="line">0x10000900 | RoundCorner#1</span><br><span class="line">0xb400007072b6af60: 10260.00 KiB | 2400 (2432) x 1080 | 1 | 1 |</span><br><span class="line">0x10000900 | MiuiPaperContrastOverlay#0</span><br><span class="line">0xb400007072b6b820: 10200.00 KiB | 1080 (1088) x 2400 | 1 | 1 |</span><br><span class="line">0x10000900 | com.android.systemui.ImageWallpaper#0</span><br><span class="line">0xb400007072b6bb30: 10200.00 KiB | 1080 (1088) x 2400 | 1 | 1 |</span><br><span class="line">0x10000900 | com.tencent.mm&#x2F;com.tencent.mm.ui.LauncherUI#0</span><br><span class="line">0xb40000710a899970: 10200.00 KiB | 1080 (1088) x 2400 | 1 | 1 | 0x1a00</span><br><span class="line">| FramebufferSurface</span><br><span class="line">0xb40000710a8999e0: 10200.00 KiB | 1080 (1088) x 2400 | 1 | 1 | 0x1a00</span><br><span class="line">| FramebufferSurface</span><br><span class="line">0xb40000710a899a50: 10200.00 KiB | 1080 (1088) x 2400 | 1 | 1 | 0x1a00</span><br><span class="line">| FramebufferSurface</span><br><span class="line">Total allocated by GraphicBufferAllocator (estimate): 88375.50 KB</span><br><span class="line">Imported gralloc buffers:</span><br><span class="line">+ name:StatusBar#0, id:146155, size:4.1e+02KiB, w&#x2F;h:1080x96, usage: 0x10000900,</span><br><span class="line">req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x96, stride:4352 bytes, size:421888</span><br><span class="line">+ name:StatusBar#0, id:146154, size:4.1e+02KiB, w&#x2F;h:1080x96, usage: 0x10000900,</span><br><span class="line">req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x96, stride:4352 bytes, size:421888</span><br><span class="line">+ name:com.tencent.mm&#x2F;com.tencent.mm.ui.LauncherUI#0, id:146141, size:1e+04KiB,</span><br><span class="line">w&#x2F;h:1080x2400, usage: 0x10000900, req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed:</span><br><span class="line">true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x2400, stride:4352 bytes, size:10522624</span><br><span class="line">+ name:com.tencent.mm&#x2F;com.tencent.mm.ui.LauncherUI#0, id:146140, size:1e+04KiB,</span><br><span class="line">w&#x2F;h:1080x2400, usage: 0x10000900, req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed:</span><br><span class="line">true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x2400, stride:4352 bytes, size:10522624</span><br><span class="line">+ name:StatusBar#0, id:146128, size:4.1e+02KiB, w&#x2F;h:1080x96, usage: 0x10000900,</span><br><span class="line">req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x96, stride:4352 bytes, size:421888</span><br><span class="line">+ name:com.android.systemui.ImageWallpaper#0, id:146111, size:1e+04KiB,</span><br><span class="line">w&#x2F;h:1080x2400, usage: 0x10000900, req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed:</span><br><span class="line">true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x2400, stride:4352 bytes, size:10522624</span><br><span class="line">+ name:RoundCorner#1, id:143978, size:8.9e+02KiB, w&#x2F;h:1080x198, usage:</span><br><span class="line">0x10000900, req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x198, stride:4352 bytes, size:913408</span><br><span class="line">+ name:NavigationBar#0, id:143940, size:6.2e+02KiB, w&#x2F;h:1080x130, usage:</span><br><span class="line">0x10000900, req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x130, stride:4352 bytes, size:634880</span><br><span class="line">+ name:NavigationBar#0, id:140021, size:6.2e+02KiB, w&#x2F;h:1080x130, usage:</span><br><span class="line">0x10000900, req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x130, stride:4352 bytes, size:634880</span><br><span class="line">+ name:NavigationBar#0, id:140019, size:6.2e+02KiB, w&#x2F;h:1080x130, usage:</span><br><span class="line">0x10000900, req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x130, stride:4352 bytes, size:634880</span><br><span class="line">+ name:RoundCorner#0, id:140017, size:8.9e+02KiB, w&#x2F;h:1080x198, usage:</span><br><span class="line">0x10000900, req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x198, stride:4352 bytes, size:913408</span><br><span class="line">+ name:RoundCorner#0, id:140016, size:8.9e+02KiB, w&#x2F;h:1080x198, usage:</span><br><span class="line">0x10000900, req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x198, stride:4352 bytes, size:913408</span><br><span class="line">+ name:RoundCorner#1, id:140015, size:8.9e+02KiB, w&#x2F;h:1080x198, usage:</span><br><span class="line">0x10000900, req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x198, stride:4352 bytes, size:913408</span><br><span class="line">+ name:MiuiPaperContrastOverlay#0, id:131391, size:1e+04KiB, w&#x2F;h:2400x1080,</span><br><span class="line">usage: 0x10000900, req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:2400x1080, stride:9728 bytes, size:10637312</span><br><span class="line">+ name:RegionSamplingThread, id:131040, size:4.1e+02KiB, w&#x2F;h:1080x96, usage:</span><br><span class="line">0x203, req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: false</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x96, stride:4352 bytes, size:417792</span><br><span class="line">+ name:MiuiPaperContrastOverlay#0, id:130894, size:1e+04KiB, w&#x2F;h:2400x1080,</span><br><span class="line">usage: 0x10000900, req fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:2400x1080, stride:9728 bytes, size:10637312</span><br><span class="line">+ name:FramebufferSurface, id:3, size:1e+04KiB, w&#x2F;h:1080x2400, usage: 0x1a00, req</span><br><span class="line">fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x2400, stride:4352 bytes, size:10522624</span><br><span class="line">+ name:FramebufferSurface, id:2, size:1e+04KiB, w&#x2F;h:1080x2400, usage: 0x1a00, req</span><br><span class="line">fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x2400, stride:4352 bytes, size:10522624</span><br><span class="line">+ name:FramebufferSurface, id:1, size:1e+04KiB, w&#x2F;h:1080x2400, usage: 0x1a00, req</span><br><span class="line">fmt:1, fourcc&#x2F;mod:875708993&#x2F;0, compressed: true</span><br><span class="line">planes: R&#x2F;G&#x2F;B&#x2F;A: w&#x2F;h:1080x2400, stride:4352 bytes, size:10522624</span><br><span class="line">Total imported by gralloc: 9e+04KiB</span><br><span class="line">TimeStats miniDump:</span><br><span class="line">Number of layers currently being tracked is 0</span><br><span class="line">Number of layers in the stats pool is 0</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<ul>
<li>之后是所有Layer的信息。这里也是一个关键，是可以看到所有Layer的信息情况。</li>
</ul>
<p>Region TransparentRegion (this=0 count=0) ——透明区域 </p>
<p>Region VisibleRegion (this=0 count=0) —— 可见区域 </p>
<p>Region SurfaceDamageRegion (this=0 count=0) ——-损坏区域 </p>
<p>layerStack= 0, z= 0, pos=(0,0), size=( 0, 0), crop=[ 0, 0, -1, -1], cornerRadius=0.000000, isProtected=0, isOpaque=0, invalidate=1, dataspace=Default, defaultPixelFormat=Unknown/None, backgroundBlurRadius=0, color=(0.000,0.000,0.000,1.000), flags=0x00000000, tr=[0.00, 0.00][0.00, 0.00]</p>
<p>&emsp;&emsp;layerStack：layer堆栈，表示这个layer保存在哪个LayerStack中；</p>
<p>&emsp;&emsp;z：z轴坐标，值越大表示越是远离Z轴圆点，该Layer越在上面；</p>
<p>&emsp;&emsp;pos：以屏幕左上角为原点，水平向右为x坐标正方向，竖直向下为y坐标正方向，其Layer的左上 点的位置；</p>
<p>&emsp;&emsp;size：Layer的宽，高；</p>
<p>&emsp;&emsp;crop：Layer的裁剪矩形，永远相对于Layer的左上点为原点计算，不已屏幕左上为原点；</p>
<p>&emsp;&emsp;cornerRadius：圆角半径；</p>
<p>&emsp;&emsp;isOpaque：是否是透明的，0表示不是完全不透明，1代表是完全不透明的；</p>
<p>&emsp;&emsp;invalidate：当前Layer的数据是失效的，1是失效的，0是有效的；</p>
<p>&emsp;&emsp;defaultPixelFormat：默认的颜色格式，有RGB_8888、RGB_4444、RGB_565等；</p>
<p>&emsp;&emsp;backgroundBlurRadius：背景表面的模糊半径；</p>
<p>&emsp;&emsp;color：第四位表示透明值alpha，正常情况下一个显示的图层，alpha应该大于0，非动画状态下 应该大部分情况都是1，如果这一位为0了，那么该图层不可见；</p>
<p>&emsp;&emsp;flag：0X01表示隐藏，如果这一位被设置了，证明该Layer被隐藏了，也是不可见的；</p>
<p>&emsp;&emsp;tr：transform，第1位，第4位表示x，y方向的缩放系数，全屏状态下为1，如果这两位为0，证 明某个方向被缩小至不可见了，整体上看上去该图层是不可见的；</p>
<p>parent=d72db53 StatusBar#0——-父节点是谁；</p>
<p>activeBuffer=[1080x 96:1088,RGBA_8888], tr=[0.00, 0.00][0.00, 0.00] queued-frames=0, mRefreshPending=0, metadata={windowType:2000, ownerUID:1000}, cornerRadiusCrop=[0.00, 0.00, 0.00, 0.00], shadowRadius=0.000,</p>
<p>&emsp;&emsp;activeBuffer=[1080x 96:1088,RGBA_8888]：当前正在显示的buffer信息，前两项是宽高，第三 项是Stride，缓冲区中的一行在内存中占用的像素数。 这可能是 &gt;= 宽度。第四项是format，颜色格式；</p>
<p>&emsp;&emsp;queued-frames：是否有新的帧，如果当前没有新的帧，这个值是0.一般在画面持续变化时(照相 预览，视频播放，窗口滑动，游戏)，这个值会是1,表示有新的一帧。偶尔也可以见到2；</p>
<p>&emsp;&emsp;mRefreshPending：几乎都是0，这个参数代表了一个layer执行了Invalidate却没有完成 Refresh；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">+ BufferQueueLayer (StatusBar#0 screenFlags &#x3D; 0)</span><br><span class="line">Region TransparentRegion (this&#x3D;0 count&#x3D;0)</span><br><span class="line">Region VisibleRegion (this&#x3D;0 count&#x3D;1)</span><br><span class="line">[ 0, 0, 1080, 96]</span><br><span class="line">Region SurfaceDamageRegion (this&#x3D;0 count&#x3D;1)</span><br><span class="line">[ 0, 0, 1080, 96]</span><br><span class="line">layerStack&#x3D; 0, z&#x3D; 0, pos&#x3D;(0,0), size&#x3D;(1080, 96), crop&#x3D;[ 0, 0,</span><br><span class="line">1080, 96], cornerRadius&#x3D;0.000000, isProtected&#x3D;0, isOpaque&#x3D;0, invalidate&#x3D;0,</span><br><span class="line">dataspace&#x3D;Default, defaultPixelFormat&#x3D;RGBA_8888, backgroundBlurRadius&#x3D;0, color&#x3D;</span><br><span class="line">(0.000,0.000,0.000,1.000), flags&#x3D;0x00000000, tr&#x3D;[0.00, 0.00][0.00, 0.00]</span><br><span class="line">parent&#x3D;d72db53 StatusBar#0 screenFlags &#x3D; 0</span><br><span class="line">zOrderRelativeOf&#x3D;none</span><br><span class="line">activeBuffer&#x3D;[1080x 96:1088,RGBA_8888], tr&#x3D;[0.00, 0.00][0.00, 0.00]</span><br><span class="line">queued-frames&#x3D;0, mRefreshPending&#x3D;0, metadata&#x3D;&#123;windowType:2000, ownerUID:1000&#125;,</span><br><span class="line">cornerRadiusCrop&#x3D;[0.00, 0.00, 0.00, 0.00], shadowRadius&#x3D;0.000,</span><br><span class="line">......</span><br><span class="line">+ ContainerLayer (bbbf69e RoundCorner#0 screenFlags &#x3D; 0)</span><br><span class="line">Region TransparentRegion (this&#x3D;0 count&#x3D;0)</span><br><span class="line">Region VisibleRegion (this&#x3D;0 count&#x3D;0)</span><br><span class="line">Region SurfaceDamageRegion (this&#x3D;0 count&#x3D;0)</span><br><span class="line">layerStack&#x3D; 0, z&#x3D; 0, pos&#x3D;(0,2202), size&#x3D;( 0, 0), crop&#x3D;[ 0,</span><br><span class="line">0, -1, -1], cornerRadius&#x3D;0.000000, isProtected&#x3D;0, isOpaque&#x3D;0, invalidate&#x3D;1,</span><br><span class="line">dataspace&#x3D;Default, defaultPixelFormat&#x3D;Unknown&#x2F;None, backgroundBlurRadius&#x3D;0,</span><br><span class="line">color&#x3D;(0.000,0.000,0.000,1.000), flags&#x3D;0x00000000, tr&#x3D;[0.00, 0.00][0.00, 0.00]</span><br><span class="line">parent&#x3D;WindowToken&#123;d6e3a23 android.os.BinderProxy@59db752&#125;#0 screenFlags &#x3D;</span><br><span class="line">0</span><br><span class="line">zOrderRelativeOf&#x3D;none</span><br><span class="line">activeBuffer&#x3D;[ 0x 0: 0,Unknown&#x2F;None], tr&#x3D;[0.00, 0.00][0.00, 0.00]</span><br><span class="line">queued-frames&#x3D;0, mRefreshPending&#x3D;0, metadata&#x3D;&#123;5:4bytes&#125;, cornerRadiusCrop&#x3D;[0.00,</span><br><span class="line">0.00, 0.00, 0.00], shadowRadius&#x3D;0.000,</span><br></pre></td></tr></table></figure>



<p><strong>PS：AndroidQ中SF能创建四种常见的Layer：BufferQueueLayer、BufferStateLayer 、ColorLayer 、 ContainerLayer</strong></p>
<ul>
<li>离屏Layer的信息。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Offscreen Layers:</span><br><span class="line">Layer Surface(name&#x3D;Task&#x3D;39180)&#x2F;@0xeededc7 - animation-leash#0 (EffectLayer)</span><br><span class="line">pid:1802 uid:1000</span><br><span class="line">Layer Surface(name&#x3D;WallpaperWindowToken&#123;6c7c7d7</span><br><span class="line">token&#x3D;android.os.Binder@a1adb56&#125;)&#x2F;@0x9e62d6c - animation-leash#0 (EffectLayer)</span><br><span class="line">pid:1802 uid:1000</span><br><span class="line">Layer Surface(name&#x3D;Task&#x3D;1)&#x2F;@0x24df5be - animation-leash#0 (EffectLayer) pid:1802</span><br><span class="line">uid:1000</span><br><span class="line">Layer Surface(name&#x3D;Task&#x3D;1)&#x2F;@0x24df5be - animation-leash#0 (EffectLayer) pid:1802</span><br><span class="line">uid:1000</span><br><span class="line">Layer Surface(name&#x3D;Task&#x3D;39180)&#x2F;@0xeededc7 - animation-leash#0 (EffectLayer)</span><br><span class="line">pid:1802 uid:100</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">扶摇直上鹏</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2021/09/06/dumpsys%20SurfaceFlinger%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">http://example.com/2021/09/06/dumpsys%20SurfaceFlinger%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">扶摇直上鹏</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">性能优化</a></div><div class="post_share"><div class="social-share" data-image="/img/sf_cover.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li></ul></div></div><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/09/05/Android-GPU/" title="Android-GPU"><img class="cover" src="/img/page_gpu.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-05</div><div class="title">Android-GPU</div></div></a></div><div><a href="/2022/03/01/App冷启动/" title="应用冷启动"><img class="cover" src="/img/page_overdraw.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-01</div><div class="title">应用冷启动</div></div></a></div><div><a href="/2022/03/21/SurfaceFlinger启动/" title="SurfaceFlinger启动"><img class="cover" src="/img/cover-004.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-21</div><div class="title">SurfaceFlinger启动</div></div></a></div><div><a href="/2020/11/05/Systrace/" title="Systrace概述"><img class="cover" src="/img/cover-005.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-05</div><div class="title">Systrace概述</div></div></a></div><div><a href="/2020/11/05/Systrace解读/" title="Systrace解读"><img class="cover" src="/img/cover-006.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-05</div><div class="title">Systrace解读</div></div></a></div><div><a href="/2021/09/05/Vsync/" title="Vsync"><img class="cover" src="/img/page_vsync.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-05</div><div class="title">Vsync</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/logo.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">扶摇直上鹏</div><div class="author-info__description">一个做Android的小学生</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/zplxl99"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/zplxl99" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:zj.zhangpeng@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">个人博客，用于分享一些在日常学习工作甚至于生活中遇到的一些比较有趣的东西。七荤八素，胡言乱语，望各位看官见谅。</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/03/21/SurfaceFlinger%E5%90%AF%E5%8A%A8/" title="SurfaceFlinger启动"><img src="/img/cover-004.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SurfaceFlinger启动"/></a><div class="content"><a class="title" href="/2022/03/21/SurfaceFlinger%E5%90%AF%E5%8A%A8/" title="SurfaceFlinger启动">SurfaceFlinger启动</a><time datetime="2022-03-21T02:39:00.000Z" title="发表于 2022-03-21 10:39:00">2022-03-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/16/%E7%AE%97%E6%B3%95%E6%8C%91%E6%88%98%E7%AC%AC%E4%B8%80%E5%A4%A9/" title="算法挑战第一天"><img src="/img/cover-004.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="算法挑战第一天"/></a><div class="content"><a class="title" href="/2022/03/16/%E7%AE%97%E6%B3%95%E6%8C%91%E6%88%98%E7%AC%AC%E4%B8%80%E5%A4%A9/" title="算法挑战第一天">算法挑战第一天</a><time datetime="2022-03-15T16:00:00.000Z" title="发表于 2022-03-16 00:00:00">2022-03-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/01/App%E5%86%B7%E5%90%AF%E5%8A%A8/" title="应用冷启动"><img src="/img/page_overdraw.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="应用冷启动"/></a><div class="content"><a class="title" href="/2022/03/01/App%E5%86%B7%E5%90%AF%E5%8A%A8/" title="应用冷启动">应用冷启动</a><time datetime="2022-03-01T13:00:00.000Z" title="发表于 2022-03-01 21:00:00">2022-03-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/13/Handler%E6%9C%BA%E5%88%B6%E4%B9%8BMessageQueue/" title="Handler机制之MessageQueue"><img src="/img/liqin-003.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Handler机制之MessageQueue"/></a><div class="content"><a class="title" href="/2022/01/13/Handler%E6%9C%BA%E5%88%B6%E4%B9%8BMessageQueue/" title="Handler机制之MessageQueue">Handler机制之MessageQueue</a><time datetime="2022-01-13T13:26:00.000Z" title="发表于 2022-01-13 21:26:00">2022-01-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/12/Binder%E6%9C%BA%E5%88%B6%E4%B9%8BServiceManager%E5%90%AF%E5%8A%A8/" title="Binder机制之ServiceManager启动"><img src="/img/cover-001.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Binder机制之ServiceManager启动"/></a><div class="content"><a class="title" href="/2022/01/12/Binder%E6%9C%BA%E5%88%B6%E4%B9%8BServiceManager%E5%90%AF%E5%8A%A8/" title="Binder机制之ServiceManager启动">Binder机制之ServiceManager启动</a><time datetime="2022-01-12T13:26:00.000Z" title="发表于 2022-01-12 21:26:00">2022-01-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By 扶摇直上鹏</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start -->
  <script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.21/hexo_githubcalendar.js"></script>
  <script data-pjax>
        function GithubCalendarConfig(){
            var git_githubapiurl ="https://python-github-calendar-api.vercel.app/api?zplxl99";
            var git_color =['#ebedf0', '#fdcdec', '#fc9bd9', '#fa6ac5', '#f838b2', '#f5089f', '#c4067e', '#92055e', '#540336', '#48022f', '#30021f'];
            var git_user ="zplxl99";
            var parent_div_git = document.getElementById('recent-posts');
            var git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/'){
                console.log('已挂载github calendar')
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }
    </script>
    <style>#github_container{min-height:280px}@media screen and (max-width:650px) {#github_container{background-image:;min-height:0px}}</style>
    <style></style><script data-pjax>function electric_clock_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img id="card-clock-loading" src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-clock/clock/images/weather/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading" class="entered loading"></div></div></div></div></div>';
                console.log('已挂载electric_clock')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='all'|| 'all' ==='all')){

            electric_clock_injector_config()
        } </script><script src="https://pv.sohu.com/cityjson?ie=utf-8"></script><script data-pjax  src="https://cdn.jsdelivr.net/gh/Zfour/hexo-electric-clock@1.0.6/clock.js"></script><!-- hexo injector body_end end --></body></html>